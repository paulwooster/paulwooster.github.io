<!DOCTYPE html>
<html>
    <header>
        <title>Mars Game</title>
        <link rel="stylesheet" href="index.css">
    </header>
    <body>
        <canvas id="canvas"></canvas>
        <button>hello</button>
        <button>world</button>
        <button>
            <img id="speedButton" src="assets/spacekit/Isometric/craft_speederA_NE.png" style="width: 100px; height: 100px; object-fit: cover;">
        </button>
        <img id="terrain_roadCross_SW" src="assets/terrain/terrain_roadCross_SW.png" width="0" height="0"> 
        <img id="speederA" src="assets/spacekit/Isometric/craft_speederA_NE.png" width="0" height="0">
<script>

// spacekit image coordinates
const ax = 256; // center x
const ay = 315; // center y 
const hx = 64 + 1; // half width
const hy = 32 + 1; // half height

// variables to track page layout
let windowWidth;
let windowHeight;
let canvasLeft;
let canvasTop;
let canvasWidth;
let canvasHeight;

// setup side bar
let leftBorder = 220;
document.body.style.backgroundColor = "#5535F0";

// variables to track mouse status
let moving = true;
let mouseX = 0;
let mouseY = 0;

// setup canvas
const canvas = document.getElementById("canvas");
canvas.style.position = 'absolute';
const ctx = canvas.getContext("2d");

// setup images
const terrain = document.getElementById("terrain_roadCross_SW");
const speederA = document.getElementById("speederA");

// create event listeners
window.addEventListener("resize",resize);
document.addEventListener("load", draw);
canvas.addEventListener("pointermove", mouseMove);
canvas.addEventListener("click", mouseClick);

// start by resizing to current window parameters
resize();

function draw() {
    // background
    ctx.fillStyle = "black";
    ctx.fillRect(0, 0, windowWidth, windowHeight);

    // terrain
    for(let row = 1; row < 10; row++){
        for(let col = -6; col < 7; col++){
            ctx.drawImage(
                terrain,
                -ax + (2 * col + row % 2) * hx,
                -ay + row * hy
            );
        }
    }

    // vehicle
    ctx.drawImage(speederA, (mouseX-ax/4), (mouseY-ay/4), ax/2, ay/2);
}

function resize() {
    windowWidth = window.innerWidth;
    windowHeight = window.innerHeight;
    canvas.width = windowWidth - leftBorder;
    canvas.height = windowHeight;
    canvas.style.left = `${leftBorder}px`;
    //canvas.style.top = `${0}px`;
    draw();
}

function mouseMove(e) {
    mouseX = e.offsetX;
    mouseY = e.offsetY;
    if (moving) {
        draw();
    }
}

function mouseClick(e) {
    moving = !moving;
    console.log("clicked");
    console.log("moving:",moving);
    if (moving) {
        draw();
    }
}

</script>
</body>
</html>
